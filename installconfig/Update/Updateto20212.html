
<!DOCTYPE html>
<html lang="" >
<head>
  <meta charset="utf-8"/>
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="book-version"      content=""/>
  <meta name="book-release"      content=""/>
  <meta name="docsearch:name"    content="Alation User Guide" />
  <meta name="docsearch:version" content="" />
  <meta name="docsearch:package_type" content="" />
	<meta name="robots" content="noindex" />

  
  <title>Update Alation to 2021.2 &mdash; Alation User Guide</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/main.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_collapse.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/rtd_sphinx_search.min.css" type="text/css" />
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Alation User Guide" href="#"/>
        <link rel="up" title="Update Alation" href="index.html"/>
        <link rel="next" title="Update Alation to 2021.1" href="Updateto20211.html"/>
        <link rel="prev" title="Update Alation to 2021.3" href="Updateto20213.html"/>

	

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67846571-1"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-67846571-1');
	</script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<!-- Second Google Analytics tag to assist mapping with mattermost.com visits --> 
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120238482-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-120238482-1');
	</script>


</head>

<body class="wy-body-for-nav" role="document">

  <header>
    <div class="header__container wy-max-content-width">
        <a href="/" class="header__logo">
            <img width="176" src="../../_static/img/logo-alation.svg" alt="Alation" />
        </a>
        <ul class="header__links">
            <li><a href="https://help.alation.com/s/">Alation Help Center</a></li>
        </ul>
    </div>
</header>

  <div class="wy-grid-for-nav wy-max-content-width">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-scroll__content">
          <div class="wy-side-nav-search">
            

            <ul class="sidebartop">
              <li class="nolink search"><div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search this project" aria-label="Search this project" id="searchinput" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
</li>

            </ul>

            
          </div>

          <div class="wy-menu wy-sidebar wy-sidebar--hidden" data-spy="affix" role="navigation" aria-label="main navigation">
            
              
              
              
                  <p class="caption" role="heading"><span class="caption-text">Welcome to Alation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/About/index.html">About Alation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/CloudAndOnPrem/index.html">Alation Cloud and On-Premise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/UserProfileandPreferences/index.html">User Profile and Preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/CatalogBasics/index.html">Catalog Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/CatalogPages/index.html">Catalog Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/Conversations/index.html">Conversations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/Domains/index.html">Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/BestPractices/index.html">Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/Glossary/index.html">Alation Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation Cloud Service</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/StatusPage/index.html">Status Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/CloudOverview/index.html">Cloud Service Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/CloudConfiguration/index.html">Configuration for Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/AlationAgent/index.html">Alation Agent</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation Integration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../integration/AlationAnywhere/index.html">Alation Anywhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integration/AlationConnectedSheets/index.html">Alation Connected Sheets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation &amp; Configuration</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ServerInstallation/index.html">Install Alation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HighAvailability/index.html">High Availability</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Update Alation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Updateto20233.html">Update Alation to 2023.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20231.html">Update Alation to 2023.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20224.html">Update Alation to 2022.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReencryptData.html">Re-Encrypt Existing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20223.html">Update Alation to 2022.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeduplicateMixedCaseUsernames.html">De-duplicate Mixed Case Usernames</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdateSourceForDataflows.html">Update Source Field for Dataflow Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20222.html">Update Alation to 2022.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20221.html">Update Alation to 2022.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="ResettingCheckpointForUserData.html">Resetting ETL Checkpoint for User Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20214.html">Update Alation to 2021.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdateFrom20214To20214Patch.html">Update Alation from 2021.4.x to 2021.4.4 or Later Patches</a></li>
<li class="toctree-l2"><a class="reference internal" href="ValidatingValueOfelasticsearch_env.html">Validating the Value of Parameter elasticsearch.env.es_java_opts</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20213.html">Update Alation to 2021.3</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Update Alation to 2021.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20211.html">Update Alation to 2021.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20204.html">Update Alation to 2020.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="20204UpgradeScript.html">Pre-Update Reindexing Script for 2020.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="Updateto20203.html">Update Alation to 2020.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdatetoVR7.html">Updating Alation to V R7 (5.12.x)</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpgradeElasticsearchVR7.html">Elasticsearch Upgrade to 7.4 FAQ and Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdatetoVR6.html">Update Alation to V R6 (5.10.x)</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpgradeInternalPostgreSQLInstances.html">Upgrade Internal PostgreSQL Instances from 9.3 to 9.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdatetoVR5.html">Update Alation to V R5 (5.9.x)</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdateSafetyBestPractice.html">Update Safety Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReleaseUpdatePrechecks.html">Release-specific Update Pre-checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="ManualSWUpdate.html">Manual Software Update for Standalone Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="updateHAPair.html">Update HA Pair Configuration (4.7 and above)</a></li>
<li class="toctree-l2"><a class="reference internal" href="UpdateHAPairwithClusterSplitting.html">Update HA Pair with Cluster Splitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="OCFUpdateAlationConnectorManager.html">Update Alation Connector Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../BackupandRestore/index.html">Back Up and Restore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LineageV2/index.html">Lineage V2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LineageV3/index.html">Lineage V3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AlationAnalyticsV2/index.html">Alation Analytics V2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AlationContainerService/index.html">Alation Container Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sources/CatalogSources/index.html">Catalog Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/VirtualDataSources/index.html">Virtual Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/Lineage/index.html">Lineage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/APIResources/index.html">API Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/WorkwithCatalogData/index.html">Working with Catalog Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/OpenConnectorFramework/index.html">Open Connector Framework</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/DSConfiguration/index.html">Data Source Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/AddDataSources/index.html">Adding Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/ComposeSSOAWSDataSources/index.html">Compose SSO for Amazon Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/ComposeSSOAzureDataSources/index.html">Compose SSO for Azure Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/AuthenticationForExtraction/index.html">Authentication for Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/CustomDB/index.html">Custom DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/GBQ/index.html">Google BigQuery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasources/Hive/index.html">Hive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BI Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../bisources/AddBISources/index.html">Add BI Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bisources/AddTableauServer/index.html">Add Tableau Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bisources/WorkwithBISources/index.html">Working with BI Sources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">File System Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/FileSystems/index.html">Add File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/VirtualFileSystems/index.html">Virtual File Systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation for Analysts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/UserAuthenticationForDataSources/index.html">User Authentication for Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/ShareAndAccessQueries/index.html">Share and Access Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/WriteQueries/index.html">Write Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/DevelopQueries/index.html">Develop Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/WorkwithQueryResults/index.html">Work with Query Results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation for Data Stewards</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../steward/GovernanceApp/index.html">Governance App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/PolicyCenter/index.html">Policy Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/Workflow/index.html">Workflow Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/GovernanceDashboard/index.html">Governance Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/StewardshipWorkbench/index.html">Stewardship Workbench</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/AnalyticsStewardship/index.html">Analytics Stewardship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/Glossary/index.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/ArticlesAndTags/index.html">Articles and Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/ArticleGroups/index.html">Article Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/DataCatalogCustomization/index.html">Customize Your Data Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/DataDocumentation/index.html">Data Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/AutoTitlingandLexicon/index.html">Auto-titling and Lexicon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/SnowflakeTags/index.html">Snowflake Tags</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation for Server Administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admins/CustomizableHomePage/index.html">Customizable Homepage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/AdminSettings/index.html">Administrator Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/AdditionalConfiguration/index.html">Additional Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/RunbookForAdministrators/index.html">Runbook for Administrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/AlationAPIs/index.html">Alation APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/How-tos/index.html">How-tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/Troubleshooting/index.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../releases/releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/supportmatrices/index.html">Support Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/endofsupport/index.html">End Of Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/snowflakeclladdon/index.html">Snowflake Parser Add-On</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/fieldnotices/index.html">Important Notices and Security Alerts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Archived Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../archive/About/index.html">About the Documentation Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/AdminConfig/index.html">Administration and Update Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/ReleaseNotes/index.html">Release Notes Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/Usage/index.html">Usage and Customization Archive</a></li>
</ul>

              
            
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="wy-nav-top-icon"></i>
        <a href="../../index.html">Alation User Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">

          <div role="navigation" aria-label="breadcrumbs" class="breadcrumbs">
    <a href="../../index.html">Docs</a>
    <span class="separator">&gt;</span>
    <a href="index.html">Update Alation</a>
    <span class="separator">&gt;</span>
    <span>Update Alation to 2021.2</span>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody" class="toBeIndexed">
            
  <section id="update-alation-to-2021-2">
<h1>Update Alation to 2021.2<a class="headerlink" href="#update-alation-to-2021-2" title="Permalink to this headline">¶</a></h1>
<p class="on-prem-label hover-text">Customer Managed <span class="tooltip-text">Applies to customer-managed instances of Alation</span></p>
<section id="update-version-dependencies">
<h2>2021.2 Update Version Dependencies<a class="headerlink" href="#update-version-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Alation supports the update to version 2021.2 from the following previous versions:</p>
<blockquote>
<div><ul>
<li><p><strong>2021.1.x</strong></p></li>
<li><p><strong>2020.4.x</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Requires key rotation to have been performed on the Alation instance at least once</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>2020.3.x</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Requires key rotation to have been performed on the Alation instance at least once</p></li>
<li><p>Requires that a Postgres reindexing script should be run on the Alation server before the update</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<section id="version-v-r7-5-12-x-and-older-versions">
<h3>Version V R7 (5.12.x) and Older Versions<a class="headerlink" href="#version-v-r7-5-12-x-and-older-versions" title="Permalink to this headline">¶</a></h3>
<p>From V R7 (5.12.x) and older versions, direct update to 2021.2 is not supported.</p>
<p>First, update Alation to a version that supports the update to 2021.2 (2020.3, 2020.4, or 2021.1) and then perform a second update to 2021.2.</p>
</section>
</section>
<section id="release-specific-information">
<span id="id1"></span><h2>2021.2 Release-Specific Information<a class="headerlink" href="#release-specific-information" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="admonition important">
<p class="admonition-title">Important</p>
<p>Additional actions are required if the updated Alation instance has to stay on Lineage V1 and/or Backup V1 after the update.</p>
</div>
</div></blockquote>
<section id="backup-v2-becomes-enabled-by-default">
<h3>Backup V2 Becomes Enabled by Default<a class="headerlink" href="#backup-v2-becomes-enabled-by-default" title="Permalink to this headline">¶</a></h3>
<p>Backup V2 becomes the default backup tool from release 2021.2. The switch-over to V2 will happen automatically during the update to 2021.2. Backup V2 will also be the default backup tool on new installations of Alation from 2021.2 and onward.</p>
<section id="what-does-this-change-mean-to-alation-admins">
<h4>What Does This Change Mean to Alation Admins?<a class="headerlink" href="#what-does-this-change-mean-to-alation-admins" title="Permalink to this headline">¶</a></h4>
<p>If your Alation instance is already on Backup V2, this change does not affect your instance, and no action is required.</p>
<p>If your Alation instance is still on Backup V1 before the update to 2021.2, please take note of this change:</p>
<ol class="arabic simple">
<li><p>Alation recommends that you stay on Backup V2 after the update. You will be able to restore backups taken by the V1 tool after Backup V2 becomes enabled as the restore process is compatible with both V1 and V2. The next consecutive backup that runs on your system after the update to 2021.2 will be performed using the Backup V2 tool.</p></li>
<li><p>If your Alation server is on Backup V1 and using HA Pair configuration, then after the update, you will need to validate that both the Primary and Secondary instances have the desired backup configuration. This is covered in the instructions for updating HA Pairs.</p></li>
<li><p>Please also consider enabling additional Backup V2 features, such as incremental backups and backup alerts. More information: <a class="reference internal" href="../BackupandRestore/BackupV1AndV2/index.html"><span class="doc">Backup V1 and Backup V2</span></a>.</p></li>
</ol>
</section>
<section id="check-current-backup-tool-version">
<h4>Check Current Backup Tool Version<a class="headerlink" href="#check-current-backup-tool-version" title="Permalink to this headline">¶</a></h4>
<p>Check the value of the <strong>alation_conf</strong> parameter <strong>alation.backup_v2.enabled</strong>. If it is in <code class="docutils literal notranslate"><span class="pre">False</span></code>, you are on Backup V1:</p>
<ol class="arabic">
<li><p>SSH to your Alation instance.</p></li>
<li><p>Enter the Alation shell:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/etc/init.d/alation<span class="w"> </span>shell
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>To check the value:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_conf<span class="w"> </span>alation.backup_v2.enabled
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Do not attempt to change this parameter manually as it will result in an incomplete transition between backup tools and an inconsistent state of the system. To enable or disable backup V2, use the appropriate <strong>alation_action</strong> command described in Backup V2 documentation.</p>
</div>
</section>
<section id="how-to-stay-on-backup-v1-after-update-to-2021-2">
<h4>How to Stay on Backup V1 After Update to 2021.2<a class="headerlink" href="#how-to-stay-on-backup-v1-after-update-to-2021-2" title="Permalink to this headline">¶</a></h4>
<p>You can return to Backup V1 by disabling Backup V2 after the update to 2021.2 (<strong>not recommended</strong>). See the Backup V2 documentation on how to disable Backup V2.</p>
<p>Note that in a future release, Alation will announce an end of support for Backup V1, and V2 will become the only available backup tool.</p>
</section>
</section>
<section id="lineage-v2-becomes-enabled-by-default">
<h3>Lineage V2 Becomes Enabled by Default<a class="headerlink" href="#lineage-v2-becomes-enabled-by-default" title="Permalink to this headline">¶</a></h3>
<p>Lineage V2 becomes the default Lineage framework on new installations of Alation and after the update to 2021.2. During the update, the Lineage V2 feature flag will be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<section id="check-current-lineage-version">
<h4>Check Current Lineage Version<a class="headerlink" href="#check-current-lineage-version" title="Permalink to this headline">¶</a></h4>
<p>To check which Lineage framework is currently in use on your Alation server:</p>
<ol class="arabic">
<li><p>SSH to your Alation host and enter the Alation shell:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/etc/init.d/alation<span class="w"> </span>shell
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Check the Lineage V2 feature flag. If it is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, you are on Lineage V1. If it is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, you are on Lineage V2:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alation_conf<span class="w"> </span>alation.feature_flags.enable_lineage_v2
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/Updateto20212.png"><img alt="../../_images/Updateto20212.png" src="../../_images/Updateto20212.png" style="width: 350px;" /></a>
</div></blockquote>
</li>
</ol>
</section>
<section id="complete-the-switch-to-lineage-v2">
<h4>Complete the Switch to Lineage V2<a class="headerlink" href="#complete-the-switch-to-lineage-v2" title="Permalink to this headline">¶</a></h4>
<p>Full migration to Lineage V2 on an existing Alation instance consists in 2 steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Enabling the Lineage V2 feature flag on the instance;</p></li>
<li><p>Migrating the existing Lineage data to the Lineage V2 framework.</p></li>
</ol>
</div></blockquote>
<p>The update to 2021.2 only enables the corresponding feature flag but does not perform the Lineage data migration.</p>
<p>If your Alation instance is on Lineage V1 before the update and you wish to stay on Lineage V2, complete the switch by performing data migration. On how to migrate your existing Lineage V1 data to the Lineage V2 framework, see <a class="reference internal" href="../LineageV2/EnableLineageV2.html"><span class="doc">Enabling Lineage V2</span></a>.</p>
</section>
<section id="how-to-stay-on-lineage-v1">
<h4>How to Stay on Lineage V1<a class="headerlink" href="#how-to-stay-on-lineage-v1" title="Permalink to this headline">¶</a></h4>
<p>If your Alation instance is on Lineage V1 before the update to 2021.2 and you wish to still stay on Lineage V1 after the update, explicitly set the Lineage V2 flag to <code class="docutils literal notranslate"><span class="pre">False</span></code> <strong>before the update</strong>. This will create an override value in <strong>alation_conf</strong> that will not be changed during the update to 2021.2. This action must be done explicitly even though you find that the value is already set to <code class="docutils literal notranslate"><span class="pre">False</span></code> on your instance.</p>
<p>To set the value:</p>
<ol class="arabic">
<li><p>SSH to your Alation host and enter the Alation shell:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/etc/init.d/alation<span class="w"> </span>shell
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Explicitly set the Lineage V2 feature flag to <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alation_conf<span class="w"> </span>alation.feature_flags.enable_lineage_v2<span class="w"> </span>-s<span class="w"> </span>False
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Restart Web:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alation_supervisor<span class="w"> </span>restart<span class="w"> </span>web:*
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</section>
</section>
<section id="built-in-driver-updates">
<h3>Built-in Driver Updates<a class="headerlink" href="#built-in-driver-updates" title="Permalink to this headline">¶</a></h3>
<p>A number of built-in drivers were updated to newer versions.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data Source Type</p></th>
<th class="head"><p>Driver Updated to Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Google BigQuery</p></td>
<td><p>Simba 1.2.12.1015</p></td>
</tr>
<tr class="row-odd"><td><p>Amazon Redshift</p></td>
<td><p>JDBC42-1.2.43.1067</p></td>
</tr>
<tr class="row-even"><td><p>Snowflake</p></td>
<td><p>3.12.16</p></td>
</tr>
</tbody>
</table>
</section>
<section id="domains-are-enabled-by-default">
<h3>Domains Are Enabled by Default<a class="headerlink" href="#domains-are-enabled-by-default" title="Permalink to this headline">¶</a></h3>
<p>In 2021.2, the Domains feature becomes enabled by default, and the corresponding feature flag is removed from <strong>Admin Settings &gt; Feature Configuration</strong>. Domains become visible in the Alation UI after at least one Domain is created.</p>
</section>
<section id="ocf-connectors-can-be-included-into-backup">
<h3>OCF Connectors Can Be Included into Backup<a class="headerlink" href="#ocf-connectors-can-be-included-into-backup" title="Permalink to this headline">¶</a></h3>
<p>Starting with 2021.2, OCF connectors will be included into the Alation backup if the <strong>.zip</strong> package with the connector is present at <strong>/opt/alation/site/site_data/ocf/connectors/</strong>.</p>
<p>Starting with 2021.2, when you install a new OCF connector using the command <code class="docutils literal notranslate"><span class="pre">alation_ypireti</span> <span class="pre">install</span> <span class="pre">--path</span> <span class="pre">&lt;path&gt;</span></code>, then during installation, Alation will also copy the <strong>.zip</strong> package with the OCF connector to the backup path <strong>/opt/alation/site/site_data/ocf/connectors/</strong> where it can be accessed by the backup process.</p>
<p>If you installed OCF connectors in releases prior to 2021.2, the corresponding <strong>.zip</strong> packages will not be present at the backup path of <strong>/opt/alation/site/site_data/ocf/connectors/</strong>. To take advantage of this feature and include the OCF connector installation packages into the backup, you will need to update the installed connectors to their current version after updating Alation to 2021.2. This step is included into the list of post-update action items below for every supported upgrade path.</p>
<section id="do-i-have-ocf-installed-on-my-instance">
<h4>Do I Have OCF Installed on My Instance?<a class="headerlink" href="#do-i-have-ocf-installed-on-my-instance" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p>You can check what Docker containers are running on the Alation host: from ourside of the Alation shell, run:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>docker<span class="w"> </span>ps
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>Alation Connector Manager is called <code class="docutils literal notranslate"><span class="pre">agent</span></code>. OCF connectors have names that follow the pattern <code class="docutils literal notranslate"><span class="pre">connector_id</span></code>, for example, <code class="docutils literal notranslate"><span class="pre">connector_6</span></code>:</p>
<blockquote>
<div><img alt="../../_images/OCF_ManageConnectors12.png" src="../../_images/OCF_ManageConnectors12.png" />
</div></blockquote>
<ol class="arabic" start="2">
<li><p>As an alternative, you can check Alation Connector Manager version. This command should be run from the Alation shell:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># to enter the Alation shell:</span>
sudo<span class="w"> </span>/etc/init.d/alation<span class="w"> </span>shell
<span class="c1"># to check Alation Connector Manager version:</span>
kratos<span class="w"> </span>--version
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>The command outputs the currently installed version of Alation Connector Manager:</p>
<blockquote>
<div><img alt="../../_images/OCF_ManageConnectors05.png" src="../../_images/OCF_ManageConnectors05.png" />
</div></blockquote>
</section>
</section>
</section>
<section id="update-known-issue">
<h2>2021.2 Update Known Issue<a class="headerlink" href="#update-known-issue" title="Permalink to this headline">¶</a></h2>
<p>If you have a password set on the internal PostgreSQL database (Rosemeta), the update to 2021.2 will result in an error:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Password for user alation: psql: fe_sendauth:</span>
<span class="go">no password supplied ERROR: Cannot upgrade alation</span>
</pre></div>
</div>
</div></blockquote>
<p>Update to 2021.2 requires that the password on the internal PostgreSQL database should be cleared for the time of the update. The password needs to be set again after the update is completed. On how to set the Postgres password, see <a class="reference internal" href="../../admins/AdditionalConfiguration/SetPasswordforPostgreSQLInstance.html"><span class="doc">Set Password for Internal Postgres Instances</span></a>.</p>
</section>
<section id="backup-check">
<h2>Backup Check<a class="headerlink" href="#backup-check" title="Permalink to this headline">¶</a></h2>
<p>Before performing any update actions, ensure that you have the latest valid Alation backup and take and store a backup or a system image, if necessary.</p>
</section>
<section id="update-2021-1-x-to-2021-2">
<h2>Update 2021.1.x to 2021.2<a class="headerlink" href="#update-2021-1-x-to-2021-2" title="Permalink to this headline">¶</a></h2>
<section id="step-1-lineage-v1">
<h3>STEP 1: Lineage V1<a class="headerlink" href="#step-1-lineage-v1" title="Permalink to this headline">¶</a></h3>
<p>If your Alation instance is on Lineage V2, skip this step.</p>
<p>If your Alation instance is on Lineage V1 before the update to 2021.2 and you wish to stay on Lineage V1 after the update to 2021.2, make sure you explicitly set required flag. See <a class="reference internal" href="#how-to-stay-on-lineage-v1">How to stay on Lineage V1</a>.</p>
</section>
<section id="step-2-run-a-postgres-scan">
<h3>STEP 2: Run a Postgres Scan<a class="headerlink" href="#step-2-run-a-postgres-scan" title="Permalink to this headline">¶</a></h3>
<p>This step is optional.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a password set on the internal PostgreSQL database, the Postgres scan will fail (a known issue). Skip this step.</p>
</div>
</div></blockquote>
<p>Before updating Alation, it is recommended to scan the internal Postgres database for corrupted indexes. If the scan finds corrupted indexes, contact Alation Support to resolve the Postgres problems before updating Alation. On how to scan Postgres: <a class="reference internal" href="../../admins/How-tos/HowToScanPostgresForCorruptedIndexes.html"><span class="doc">How to Scan Postgres For Corrupted Indexes</span></a>.</p>
</section>
<section id="step-3-update-alation-to-2021-2">
<h3>STEP 3: Update Alation to 2021.2<a class="headerlink" href="#step-3-update-alation-to-2021-2" title="Permalink to this headline">¶</a></h3>
<p>Proceed to update the Alation application using the appropriate update instructions:</p>
<ul>
<li><p><a class="reference internal" href="ManualSWUpdate.html"><span class="doc">Manual Software Update for Standalone Systems</span></a></p></li>
<li><p>Update on the HA Pair:</p>
<blockquote>
<div><ul class="simple">
<li><p>with splitting the HA cluster: <a class="reference internal" href="UpdateHAPairwithClusterSplitting.html"><span class="doc">Update HA Pair with Cluster Splitting</span></a></p></li>
<li><p>without splitting the cluster: <a class="reference internal" href="updateHAPair.html"><span class="doc">Update HA Pair Configuration (4.7 and above)</span></a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="step-4-update-alation-analytics-v2">
<h3>STEP 4: Update Alation Analytics V2<a class="headerlink" href="#step-4-update-alation-analytics-v2" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Perform this step only if Alation Analytics V2 is in use on your instance.</p>
</div>
<p>Release 2021.2 includes an updated version of Alation Analytics V2. Use the steps in <a class="reference internal" href="../AlationAnalyticsV2/UpdateAlationAnalyticsV2.html"><span class="doc">Update Alation Analytics V2</span></a> to update Alation Analytics V2.</p>
</section>
<section id="step-5-update-ocf-connectors">
<h3>STEP 5: Update OCF Connectors<a class="headerlink" href="#step-5-update-ocf-connectors" title="Permalink to this headline">¶</a></h3>
<p>Perform this step only if OCF connectors are in use on your instance. See <a class="reference internal" href="#ocf-connectors-can-be-included-into-backup">OCF Connectors Can Be Included into Backup</a> about why you need to perform this step.</p>
<p>To update, run the <code class="docutils literal notranslate"><span class="pre">alation_ypireti</span> <span class="pre">update</span></code> command specifying the ID of the connector and pointing the path to the <strong>.zip</strong> file of the current version of the OCF connector on your Alation host. Because you are updating the connector to the same version, there will be no changes to any data in Alation and the command will place the <strong>.zip</strong> file into the backup path.</p>
<p>On how to run the update command for an OCF connector, see <a class="reference internal" href="../../sources/OpenConnectorFramework/OCFMaintainConnectors.html#ocf-maintain-connectors-update"><span class="std std-ref">Update a Connector</span></a>.</p>
</section>
<section id="step-6-migrate-lineage-data-to-lineage-v2">
<h3>STEP 6: Migrate Lineage Data to Lineage V2<a class="headerlink" href="#step-6-migrate-lineage-data-to-lineage-v2" title="Permalink to this headline">¶</a></h3>
<p>Perform this step only if your Alation instance was on Lineage V1 before the update and now you wish to complete the switch to Lineage V2. See <a class="reference internal" href="#complete-the-switch-to-lineage-v2">Complete the Switch to Lineage V2</a> on how to fully switch to Lineage V2.</p>
</section>
</section>
<section id="update-2020-4-to-2021-2">
<h2>Update 2020.4 to 2021.2<a class="headerlink" href="#update-2020-4-to-2021-2" title="Permalink to this headline">¶</a></h2>
<section id="id2">
<h3>STEP 1: Lineage V1<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>If your Alation instance is on Lineage V2, skip this step.</p>
<p>If your Alation instance is on Lineage V1 before the update to 2021.2 and you wish to stay on Lineage V1 after the update to 2021.2, make sure you explicitly set required flag. See <a class="reference internal" href="#how-to-stay-on-lineage-v1">How to stay on Lineage V1</a>.</p>
</section>
<section id="step-2-perform-encryption-key-rotation">
<h3>STEP 2: Perform Encryption Key Rotation<a class="headerlink" href="#step-2-perform-encryption-key-rotation" title="Permalink to this headline">¶</a></h3>
<p>The update from 2020.4 to 2021.2 cannot be done if key rotation has never been performed on the Alation instance. The 2021.2 update command will stop with a <strong>key rotation required</strong> warning.</p>
<p>If you have not recently done so, perform the encryption key rotation on the Alation Server. On large installations, if key rotation has never been performed before, the initial key rotation may take several hours to complete.</p>
<section id="key-rotation-on-ha-pair">
<h4>Key Rotation on HA Pair<a class="headerlink" href="#key-rotation-on-ha-pair" title="Permalink to this headline">¶</a></h4>
<p>Key rotation should be done on the <strong>Primary</strong> server.</p>
<p>If you plan to update the HA Pair with splitting the cluster, perform key rotation on Primary before splitting the Pair.</p>
<p>After key rotation on the Primary is completed, allow some time for replication to happen between Primary and Secondary. The cluster should be in sync before you update or split and update.</p>
<p>On how to perform key rotation: <a class="reference internal" href="../../admins/AdminSettings/EncryptionKeyRotation.html"><span class="doc">Encryption Key Rotation</span></a></p>
</section>
</section>
<section id="step-3-take-an-additional-backup">
<h3>STEP 3: Take an Additional Backup<a class="headerlink" href="#step-3-take-an-additional-backup" title="Permalink to this headline">¶</a></h3>
<p>It is highly recommended to take an additional Alation backup after successfully performing key rotation. This backup is required if you have to restore using a 2021.2 build. You cannot restore data that did not have at least one key rotation.</p>
</section>
<section id="step-4-run-a-postgres-scan">
<h3>STEP 4: Run a Postgres Scan<a class="headerlink" href="#step-4-run-a-postgres-scan" title="Permalink to this headline">¶</a></h3>
<p>This step is optional.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a password set on the internal PostgreSQL database, the Postgres scan will fail (a known issue). Skip this step.</p>
</div>
</div></blockquote>
<p>After the encryption key rotation and before updating Alation, it is recommended to scan the internal Postgres database for corrupted indexes. If the scan finds corrupted indexes in Postgres, contact Alation Support to resolve the Postgres problems before updating Alation.</p>
<p>On how to scan Postgres: <a class="reference internal" href="../../admins/How-tos/HowToScanPostgresForCorruptedIndexes.html"><span class="doc">How to Scan Postgres For Corrupted Indexes</span></a></p>
</section>
<section id="step-5-update-alation-to-2021-2">
<h3>STEP 5: Update Alation To 2021.2<a class="headerlink" href="#step-5-update-alation-to-2021-2" title="Permalink to this headline">¶</a></h3>
<p>Proceed to update the Alation application using the appropriate update instructions:
- <a class="reference internal" href="ManualSWUpdate.html"><span class="doc">Manual Software Update for Standalone Systems</span></a>
- Update on the HA Pair:</p>
<blockquote>
<div><ul class="simple">
<li><p>with splitting the HA cluster: <a class="reference internal" href="UpdateHAPairwithClusterSplitting.html"><span class="doc">Update HA Pair with Cluster Splitting</span></a></p></li>
<li><p>without splitting the cluster: <a class="reference internal" href="updateHAPair.html"><span class="doc">Update HA Pair Configuration (4.7 and above)</span></a></p></li>
</ul>
</div></blockquote>
</section>
<section id="step-6-perform-post-update-steps">
<h3>STEP 6: Perform Post-Update Steps<a class="headerlink" href="#step-6-perform-post-update-steps" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Perform this step only if using Alation Analytics V2:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../AlationAnalyticsV2/UpdateAlationAnalyticsV2.html"><span class="doc">Update Alation Analytics V2</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Perform this step only if using OCF Framework. Update Alation Connector Manager:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="OCFUpdateAlationConnectorManager.html"><span class="doc">Update Alation Connector Manager</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Perform this step only if OCF Connectors are in use on your instance: update OCF Connectors.</p>
<blockquote>
<div><p>See <a class="reference internal" href="#ocf-connectors-can-be-included-into-backup">OCF Connectors Can Be Included into Backup</a> about why you need to perform this step.
To update, run the <code class="docutils literal notranslate"><span class="pre">alation_ypireti</span> <span class="pre">update</span></code> command specifying the ID of the connector and pointing the path to the .zip file of the current version of the OCF connector on your Alation server. Because you are updating the connector to the same version, there will be no changes to any data in Alation and the command will place the <strong>.zip</strong> file into the backup path. On how to run the update command for an OCF connector, see <a class="reference internal" href="../../sources/OpenConnectorFramework/OCFMaintainConnectors.html#ocf-maintain-connectors-update"><span class="std std-ref">Update a Connector</span></a>.</p>
</div></blockquote>
</li>
<li><p>Perform this step only if your Alation instance was on Lineage V1 before the update and now you wish to complete the switch to Lineage V2. See <a class="reference internal" href="#complete-the-switch-to-lineage-v2">Complete the Switch to Lineage V2</a> on how to fully switch to Lineage V2.</p></li>
</ol>
</section>
</section>
<section id="update-2020-3-to-2021-2">
<span id="update-20212-20203-20212"></span><h2>Update 2020.3 To 2021.2<a class="headerlink" href="#update-2020-3-to-2021-2" title="Permalink to this headline">¶</a></h2>
<p>This update scenario skips release 2020.4.x which includes a number of major changes in the Alation application. The changes in 2020.4 cause a number of additional checks and steps in the process of updating Alation.</p>
<p>If you have chosen to skip the 2020.4.x release and update to 2021.2 from 2020.3, do the following before the upgrade:</p>
<ol class="arabic">
<li><p>Inform yourself on the changes in 2020.4:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../../releases/releasenotes/ReleaseNotes20204.html"><span class="doc">Release Notes 2020.4 (General Availability)</span></a></p></li>
<li><p><a class="reference internal" href="Updateto20204.html#release-specific-information"><span class="std std-ref">2020.4 Release-Specific information</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Make a list of post-upgrade steps that may be relevant to your instance in the releases you skip (2020.3 and 2020.4). You will need to address those after the update as well:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="Updateto20204.html#update-20204-post-upgrade"><span class="std std-ref">Post-Upgrade Steps 2020.4</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Create an update schedule that accommodates for the required pre-update steps, such as Postgres re-indexing and encryption key rotation (see below) and the post-update steps relevant to your instance.</p></li>
<li><p>Make sure you have the latest valid Alation backup.</p></li>
</ol>
<p>To update Alation from 2020.3 to 2021.2, follow the steps below:</p>
<section id="step-1-required-checks">
<h3>STEP 1: Required Checks<a class="headerlink" href="#step-1-required-checks" title="Permalink to this headline">¶</a></h3>
<section id="internal-postgresql-upgrade-to-9-6-is-required">
<h4>Internal PostgreSQL upgrade to 9.6 is required<a class="headerlink" href="#internal-postgresql-upgrade-to-9-6-is-required" title="Permalink to this headline">¶</a></h4>
<p>If Postgres is not 9.6, you need to first <a class="reference internal" href="UpgradeInternalPostgreSQLInstances.html"><span class="doc">Upgrade Internal PostgreSQL Instances from 9.3 to 9.6</span></a>.</p>
</section>
<section id="elasticsearch-migration-from-1-4-to-7-4-should-be-complete">
<h4>Elasticsearch migration from 1.4 to 7.4 should be complete<a class="headerlink" href="#elasticsearch-migration-from-1-4-to-7-4-should-be-complete" title="Permalink to this headline">¶</a></h4>
<p>To check the Elasticsearch version that is currently in use on your instance, from the Alation shell, run:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_conf<span class="w"> </span>elasticsearch.backend_mode
</pre></div>
</div>
<p>It should be set to <strong>2</strong>. If you see a different value, you will not be able to update as Elasticsearch migration may not have happened. In this case, contact Alation Support to assist with the update.</p>
</section>
</section>
<section id="lineage-v1-check">
<h3>Lineage V1 Check<a class="headerlink" href="#lineage-v1-check" title="Permalink to this headline">¶</a></h3>
<p>If your Alation instance is on Lineage V2, skip this step.</p>
<p>If your Alation instance is on Lineage V1 before the update to 2021.2 and you wish to stay on Lineage V1 after the update to 2021.2, make sure you explicitly set required flag. See <a class="reference internal" href="#how-to-stay-on-lineage-v1">How to stay on Lineage V1</a>.</p>
</section>
<section id="id3">
<h3>STEP 2: Perform Encryption Key Rotation<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Update to 2021.2 cannot be done if key rotation has never been performed on the instance.
If you have not recently done so, perform the encryption key rotation on the Alation Server. On large instances, if key rotation has never been performed before, the initial key rotation may take up to a week to complete.</p>
<section id="id4">
<h4>Key Rotation on HA Pair<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Key rotation should be done on the <strong>Primary</strong> server.</p>
<p>If you plan to update the HA Pair with splitting the cluster, perform key rotation on Primary before splitting the Pair.</p>
<p>After key rotation on the Primary is completed, allow some time for replication to happen between Primary and Secondary. The cluster should be in sync before you update or split and update.</p>
<p>On how to perform key rotation: <a class="reference internal" href="../../admins/AdminSettings/EncryptionKeyRotation.html"><span class="doc">Encryption Key Rotation</span></a></p>
</section>
</section>
<section id="id5">
<h3>STEP 3: Take an Additional Backup<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>It is recommended to take an additional Alation backup after successfully performing key rotation. This backup is required if you have to restore using a 2021.2 build. You cannot restore data that did not have at least one key rotation.</p>
</section>
<section id="step-4-run-pre-upgrade-reindexing-script">
<h3>STEP 4: Run Pre-Upgrade Reindexing Script<a class="headerlink" href="#step-4-run-pre-upgrade-reindexing-script" title="Permalink to this headline">¶</a></h3>
<p>Running of the reindexing script is required because of the changes in release 2020.4.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On HA Pair, the reindexing script should be run on the Primary instance.</p>
</div>
<ol class="arabic">
<li><p>Copy and save the following script as <code class="docutils literal notranslate"><span class="pre">preupgrade_reindexing.py</span></code> to <strong>/opt/alation/alation/opt/alation/</strong> on the Alation host (path outside the Alation shell): <a class="reference internal" href="20204UpgradeScript.html"><span class="doc">Pre-Update Reindexing Script for 2020.4</span></a></p></li>
<li><p>Is it recommended to run the script in a Screen session. To start a Screen session:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>screen<span class="w"> </span>-S<span class="w"> </span>reindex_db
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>From the Alation shell, change user to Alation:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/etc/init.d/alation<span class="w"> </span>shell
sudo<span class="w"> </span>su<span class="w"> </span>alation
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Update the permissions on the <code class="docutils literal notranslate"><span class="pre">preupgrade_reindexing.py</span></code> script so that it can be executed by user <code class="docutils literal notranslate"><span class="pre">alation</span></code>:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>/opt/alation/
sudo<span class="w"> </span>chown<span class="w"> </span>alation:alation<span class="w"> </span>preupgrade_reindexing.py
chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>preupgrade_reindexing.py
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the script from <strong>/opt/alation/</strong> (inside the Alation shell) with the command given below. This script stops all Alation services except Postgres. Do not start any of the services while the script is running as this can result in an inconsistent state of the data.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>preupgrade_reindexing.py
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>The script prints its output to the console and to <strong>/opt/alation/site/site_data/pre_upgrade_reindex_rosemeta_db.log</strong> (path inside the shell).</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In case the script execution fails, do not proceed with the update. Contact Alation Support to troubleshoot and assist with the next steps.</p>
</div>
</div></blockquote>
<p>The time required for reindexing to complete depends on the size of the internal database. During the update, Alation will run a second re-indexing. The update time will be increased by approximately this amount of time when the second reindexing runs automatically during the update.</p>
<p>After the reindexing script completes, proceed to step 5.</p>
</section>
<section id="id6">
<h3>STEP 5: Update Alation To 2021.2<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p><a class="reference internal" href="ManualSWUpdate.html"><span class="doc">Manual Software Update for Standalone Systems</span></a></p></li>
<li><p>Update on the HA Pair:</p>
<blockquote>
<div><ul class="simple">
<li><p>with splitting the HA cluster: <a class="reference internal" href="UpdateHAPairwithClusterSplitting.html"><span class="doc">Update HA Pair with Cluster Splitting</span></a></p></li>
<li><p>without splitting the cluster: <a class="reference internal" href="updateHAPair.html"><span class="doc">Update HA Pair Configuration (4.7 and above)</span></a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="id7">
<h3>STEP 6: Perform Post-Update Steps<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Do the post-update steps for release 2020.4 that are relevant to your Alation instance</p></li>
<li><p>Perform this step only if using Alation Analytics V2:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../AlationAnalyticsV2/UpdateAlationAnalyticsV2.html"><span class="doc">Update Alation Analytics V2</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Perform this step only if using OCF Framework. Update Alation Connector Manager:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="OCFUpdateAlationConnectorManager.html"><span class="doc">Update Alation Connector Manager</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Perform this step only if OCF Connectors are in use on your instance: update OCF Connectors.</p>
<blockquote>
<div><p>See <a class="reference internal" href="#ocf-connectors-can-be-included-into-backup">OCF Connectors Can Be Included into Backup</a> about why you need to perform this step.
To update, run the <code class="docutils literal notranslate"><span class="pre">alation_ypireti</span> <span class="pre">update</span></code> command specifying the ID of the connector and pointing the path to the .zip file of the current version of the OCF connector on your Alation server. Because you are updating the connector to the same version, there will be no changes to any data in Alation and the command will place the <strong>.zip</strong> file into the backup path. On how to run the update command for an OCF connector, see <a class="reference internal" href="../../sources/OpenConnectorFramework/OCFMaintainConnectors.html#ocf-maintain-connectors-update"><span class="std std-ref">Update a Connector</span></a>.</p>
</div></blockquote>
</li>
<li><p>Perform this step only if your Alation instance was on Lineage V1 before the update and now you wish to complete the switch to Lineage V2. See <a class="reference internal" href="#complete-the-switch-to-lineage-v2">Complete the Switch to Lineage V2</a> on how to fully switch to Lineage V2.</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  
<div class="navigation-bar">

    <div class="navigation navigation--prev">
        
        <a class="navigation__link" href="Updateto20213.html">
            <button class="navigation__button">
                <i class="icon icon-left"></i>
            </button>
            <div class="navigation__title">
                <span class="heading">Previous</span> <br />Update Alation to 2021.3
            </div>
        </a>
        
    </div>

    <div class="navigation navigation--next">
        
        <a class="navigation__link" title="Accesskey Alt(+Shift)+p" accesskey="p" href="Updateto20211.html">
            <div class="navigation__title">
                <span class="heading">Next</span> <br />Update Alation to 2021.1
            </div>
            <button class="navigation__button" title="Accesskey Alt(+Shift)+n" accesskey="n">
                <i class="icon icon-right"></i>
            </button>
        </a>
        
    </div>

</div>


</footer>

        </div>
      </div>

    </section>

    <div class="wy-nav-side wy-nav-secondary">
      <div class="wy-side-scroll">
        <div class="wy-side-scroll__content">
          <div class="wy-menu-secondary">
              <div class="comments">
    <a href="mailto:no-reply-docs-feedback@alation.com?subject=Documentation Feedback on installconfig/Update/Updateto20212&body=Alation%20welcomes%20your%20comments%20on%20typos,%20content%20accuracy%20and%20completeness,%20and%20whether%20you%20found%20this%20page%20helpful.%20You%20will%20not%20receive%20a%20reply%20to%20this%20email.">
        <i class="icon icon-envelope" aria-hidden="true"></i>Request docs changes
    </a>
    <a href="#open-modal-pdf">
        <i class="icon icon-pdf" aria-hidden="true"></i>Download PDF
    </a>
</div>
              
                <p class="wy-menu-secondary-header">On this page</p>
                <ul>
<li><a class="reference internal" href="#">Update Alation to 2021.2</a><ul>
<li><a class="reference internal" href="#update-version-dependencies">2021.2 Update Version Dependencies</a><ul>
<li><a class="reference internal" href="#version-v-r7-5-12-x-and-older-versions">Version V R7 (5.12.x) and Older Versions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#release-specific-information">2021.2 Release-Specific Information</a><ul>
<li><a class="reference internal" href="#backup-v2-becomes-enabled-by-default">Backup V2 Becomes Enabled by Default</a><ul>
<li><a class="reference internal" href="#what-does-this-change-mean-to-alation-admins">What Does This Change Mean to Alation Admins?</a></li>
<li><a class="reference internal" href="#check-current-backup-tool-version">Check Current Backup Tool Version</a></li>
<li><a class="reference internal" href="#how-to-stay-on-backup-v1-after-update-to-2021-2">How to Stay on Backup V1 After Update to 2021.2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lineage-v2-becomes-enabled-by-default">Lineage V2 Becomes Enabled by Default</a><ul>
<li><a class="reference internal" href="#check-current-lineage-version">Check Current Lineage Version</a></li>
<li><a class="reference internal" href="#complete-the-switch-to-lineage-v2">Complete the Switch to Lineage V2</a></li>
<li><a class="reference internal" href="#how-to-stay-on-lineage-v1">How to Stay on Lineage V1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#built-in-driver-updates">Built-in Driver Updates</a></li>
<li><a class="reference internal" href="#domains-are-enabled-by-default">Domains Are Enabled by Default</a></li>
<li><a class="reference internal" href="#ocf-connectors-can-be-included-into-backup">OCF Connectors Can Be Included into Backup</a><ul>
<li><a class="reference internal" href="#do-i-have-ocf-installed-on-my-instance">Do I Have OCF Installed on My Instance?</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#update-known-issue">2021.2 Update Known Issue</a></li>
<li><a class="reference internal" href="#backup-check">Backup Check</a></li>
<li><a class="reference internal" href="#update-2021-1-x-to-2021-2">Update 2021.1.x to 2021.2</a><ul>
<li><a class="reference internal" href="#step-1-lineage-v1">STEP 1: Lineage V1</a></li>
<li><a class="reference internal" href="#step-2-run-a-postgres-scan">STEP 2: Run a Postgres Scan</a></li>
<li><a class="reference internal" href="#step-3-update-alation-to-2021-2">STEP 3: Update Alation to 2021.2</a></li>
<li><a class="reference internal" href="#step-4-update-alation-analytics-v2">STEP 4: Update Alation Analytics V2</a></li>
<li><a class="reference internal" href="#step-5-update-ocf-connectors">STEP 5: Update OCF Connectors</a></li>
<li><a class="reference internal" href="#step-6-migrate-lineage-data-to-lineage-v2">STEP 6: Migrate Lineage Data to Lineage V2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#update-2020-4-to-2021-2">Update 2020.4 to 2021.2</a><ul>
<li><a class="reference internal" href="#id2">STEP 1: Lineage V1</a></li>
<li><a class="reference internal" href="#step-2-perform-encryption-key-rotation">STEP 2: Perform Encryption Key Rotation</a><ul>
<li><a class="reference internal" href="#key-rotation-on-ha-pair">Key Rotation on HA Pair</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-3-take-an-additional-backup">STEP 3: Take an Additional Backup</a></li>
<li><a class="reference internal" href="#step-4-run-a-postgres-scan">STEP 4: Run a Postgres Scan</a></li>
<li><a class="reference internal" href="#step-5-update-alation-to-2021-2">STEP 5: Update Alation To 2021.2</a></li>
<li><a class="reference internal" href="#step-6-perform-post-update-steps">STEP 6: Perform Post-Update Steps</a></li>
</ul>
</li>
<li><a class="reference internal" href="#update-2020-3-to-2021-2">Update 2020.3 To 2021.2</a><ul>
<li><a class="reference internal" href="#step-1-required-checks">STEP 1: Required Checks</a><ul>
<li><a class="reference internal" href="#internal-postgresql-upgrade-to-9-6-is-required">Internal PostgreSQL upgrade to 9.6 is required</a></li>
<li><a class="reference internal" href="#elasticsearch-migration-from-1-4-to-7-4-should-be-complete">Elasticsearch migration from 1.4 to 7.4 should be complete</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lineage-v1-check">Lineage V1 Check</a></li>
<li><a class="reference internal" href="#id3">STEP 2: Perform Encryption Key Rotation</a><ul>
<li><a class="reference internal" href="#id4">Key Rotation on HA Pair</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5">STEP 3: Take an Additional Backup</a></li>
<li><a class="reference internal" href="#step-4-run-pre-upgrade-reindexing-script">STEP 4: Run Pre-Upgrade Reindexing Script</a></li>
<li><a class="reference internal" href="#id6">STEP 5: Update Alation To 2021.2</a></li>
<li><a class="reference internal" href="#id7">STEP 6: Perform Post-Update Steps</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              
            </div>
          </div>
      </div>
    </div>

  </div>

  
  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->

  
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../../_static/copybutton.js"></script>
      <script type="text/javascript" src="../../_static/js/rtd_sphinx_search.min.js"></script>
  
  <script type="text/javascript" src="../../_static/searchtools.js"></script> <script type="text/javascript" id="idPiwikScriptPlaceholder"></script><script type="text/javascript" src="../../_static/js/main.bundle.js"></script>
  <script type="text/javascript" src="../../_static/js/runtime.bundle.js"></script>

  
  

  
    <div id="open-modal-pdf" class="modal-window">
<div>
  <a href="#" title="Close" class="modal-close">Close</a>
  <h4>Alation Documentation PDF</h4>
  <p>This PDF contains all our documentation and is more than <b>120 MB</b> in size. We recommend using an ethernet or Wi-Fi connection for downloading.</p>
  <br>
  <div class="modal-buttons">
    <a href="https://pdf-docs.alation.com/AlationUserDocs.pdf" class="btn-cta btn-cta--primary" target="_blank">
      Download PDF
    </a>
    <a href="#" title="Close" class="btn-cta">Cancel</a>
  </div>
</div>
  

</body>
</html>
<!--3.6.17-->