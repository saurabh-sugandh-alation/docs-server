
<!DOCTYPE html>
<html lang="" >
<head>
  <meta charset="utf-8"/>
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="book-version"      content=""/>
  <meta name="book-release"      content=""/>
  <meta name="docsearch:name"    content="Alation User Guide" />
  <meta name="docsearch:version" content="" />
  <meta name="docsearch:package_type" content="" />
	<meta name="robots" content="noindex" />

  
  <title>Compose SSO for Azure Data Sources: Configure Compose SSO in Alation &mdash; Alation User Guide</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/main.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_collapse.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/rtd_sphinx_search.min.css" type="text/css" />
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Alation User Guide" href="#"/>
        <link rel="up" title="Compose SSO for Azure Data Sources" href="index.html"/>
        <link rel="next" title="OAuth Plugin CRUD Operations" href="OAuthPluginCRUDOperations.html"/>
        <link rel="prev" title="Compose SSO for Azure Data Sources: Register an Application in Azure AD" href="RegisterAADappForComposeSSO.html"/>

	

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67846571-1"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-67846571-1');
	</script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<!-- Second Google Analytics tag to assist mapping with mattermost.com visits --> 
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120238482-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-120238482-1');
	</script>


</head>

<body class="wy-body-for-nav" role="document">

  <header>
    <div class="header__container wy-max-content-width">
        <a href="/" class="header__logo">
            <img width="176" src="../../_static/img/logo-alation.svg" alt="Alation" />
        </a>
        <ul class="header__links">
            <li><a href="https://help.alation.com/s/">Alation Help Center</a></li>
        </ul>
    </div>
</header>

  <div class="wy-grid-for-nav wy-max-content-width">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-scroll__content">
          <div class="wy-side-nav-search">
            

            <ul class="sidebartop">
              <li class="nolink search"><div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search this project" aria-label="Search this project" id="searchinput" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
</li>

            </ul>

            
          </div>

          <div class="wy-menu wy-sidebar wy-sidebar--hidden" data-spy="affix" role="navigation" aria-label="main navigation">
            
              
              
              
                  <p class="caption" role="heading"><span class="caption-text">Welcome to Alation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/About/index.html">About Alation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/CloudAndOnPrem/index.html">Alation Cloud and On-Premise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/QuickStart/index.html">Quick Start Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/UserProfileandPreferences/index.html">User Profile and Preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/CatalogBasics/index.html">Catalog Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/Conversations/index.html">Conversations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/Domains/index.html">Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/BestPractices/index.html">Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../welcome/Glossary/index.html">Alation Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation Cloud Service</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/StatusPage/index.html">Status Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/CloudOverview/index.html">Cloud Service Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/CloudConfiguration/index.html">Configuration for Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cloud/AlationAgent/index.html">Alation Agent</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation Integration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../integration/AlationAnywhere/index.html">Alation Anywhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integration/AlationConnectedSheets/index.html">Alation Connected Sheets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/ServerInstallation/index.html">Install Alation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/HighAvailability/index.html">High Availability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/Runbook/index.html">Runbook for Administrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/Update/index.html">Update Alation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/BackupandRestore/index.html">Back Up and Restore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/LineageV2/index.html">Lineage V2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/LineageV3/index.html">Lineage V3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/AlationAnalyticsV2/index.html">Alation Analytics V2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installconfig/AlationContainerService/index.html">Alation Container Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sources/CatalogSources/index.html">Catalog Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/VirtualDataSources/index.html">Virtual Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/Lineage/index.html">Lineage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/APIResources/index.html">API Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/WorkwithCatalogData/index.html">Working with Catalog Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sources/OpenConnectorFramework/index.html">Open Connector Framework</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Sources</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../DSConfiguration/index.html">Data Source Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AddDataSources/index.html">Adding Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ComposeSSOAWSDataSources/index.html">Compose SSO for Amazon Data Sources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Compose SSO for Azure Data Sources</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="RegisterAADappForComposeSSO.html">Compose SSO for Azure Data Sources: Register an Application in Azure AD</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Compose SSO for Azure Data Sources: Configure Compose SSO in Alation</a></li>
<li class="toctree-l2"><a class="reference internal" href="OAuthPluginCRUDOperations.html">OAuth Plugin CRUD Operations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../AuthenticationForExtraction/index.html">Authentication for Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CustomDB/index.html">Custom DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GBQ/index.html">Google BigQuery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Hive/index.html">Hive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BI Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../bisources/AddBISources/index.html">Add BI Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bisources/AddTableauServer/index.html">Add Tableau Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bisources/WorkwithBISources/index.html">Working with BI Sources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">File System Sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/FileSystems/index.html">Add File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/VirtualFileSystems/index.html">Virtual File Systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation for Analysts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/UserAuthenticationForDataSources/index.html">User Authentication for Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/ShareAndAccessQueries/index.html">Share and Access Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/WriteQueries/index.html">Write Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/DevelopQueries/index.html">Develop Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyst/WorkwithQueryResults/index.html">Work with Query Results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation for Data Stewards</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../steward/GovernanceApp/index.html">Governance App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/PolicyCenter/index.html">Policy Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/Workflow/index.html">Workflow Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/GovernanceDashboard/index.html">Governance Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/StewardshipWorkbench/index.html">Stewardship Workbench</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/AnalyticsStewardship/index.html">Analytics Stewardship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/Glossary/index.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/ArticlesAndTags/index.html">Articles and Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/ArticleGroups/index.html">Article Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/DataCatalogCustomization/index.html">Customize Your Data Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/DataDocumentation/index.html">Data Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/AutoTitlingandLexicon/index.html">Auto-titling and Lexicon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steward/SnowflakeTags/index.html">Snowflake Tags</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alation for Server Administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admins/CustomizableHomePage/index.html">Customizable Homepage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/AdminSettings/index.html">Administrator Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/AdditionalConfiguration/index.html">Additional Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/RunbookForAdministrators/index.html">Runbook for Administrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/AlationAPIs/index.html">Alation APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/How-tos/index.html">How-tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admins/Troubleshooting/index.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../releases/releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/supportmatrices/index.html">Support Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/endofsupport/index.html">End Of Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/snowflakeclladdon/index.html">Snowflake Parser Add-On</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/fieldnotices/index.html">Important Notices and Security Alerts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Archived Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../archive/About/index.html">About the Documentation Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/AdminConfig/index.html">Administration and Update Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/ReleaseNotes/index.html">Release Notes Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/Usage/index.html">Usage and Customization Archive</a></li>
</ul>

              
            
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="wy-nav-top-icon"></i>
        <a href="../../index.html">Alation User Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">

          <div role="navigation" aria-label="breadcrumbs" class="breadcrumbs">
    <a href="../../index.html">Docs</a>
    <span class="separator">&gt;</span>
    <a href="index.html">Compose SSO for Azure Data Sources</a>
    <span class="separator">&gt;</span>
    <span>Compose SSO for Azure Data Sources: Configure Compose SSO in Alation</span>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody" class="toBeIndexed">
            
  <section id="compose-sso-for-azure-data-sources-configure-compose-sso-in-alation">
<h1>Compose SSO for Azure Data Sources: Configure Compose SSO in Alation<a class="headerlink" href="#compose-sso-for-azure-data-sources-configure-compose-sso-in-alation" title="Permalink to this headline">¶</a></h1>
<p><em>Available from version 2021.4</em></p>
<p>Compose SSO for Azure SQL data sources uses the OAuth plug-in of Alation’s <em>AuthService</em> and requires the AuthService to be enabled on your Alation server.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before performing this configuration:</p>
<ol class="arabic">
<li><p>Make sure you have registered Compose with Azure AD: <a class="reference internal" href="RegisterAADappForComposeSSO.html"><span class="doc">Compose SSO for Azure Data Sources: Register an Application in Azure AD</span></a>.</p></li>
<li><p>Make sure you have the required Azure AD information at hand:</p>
<blockquote>
<div><ul>
<li><p>The client ID of the Compose application registration in Azure AD</p></li>
<li><p>Application client secret value</p></li>
<li><p>OAuth 2.0 endpoints</p>
<blockquote>
<div><ul class="simple">
<li><p>OAuth token endpoint URL</p></li>
<li><p>OAuth authorize endpoint URL</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Prepare the Alation IDs of the data sources for which you are configuring Compose SSO. See <a class="reference internal" href="../../admins/How-tos/HowToFindDataSourceID.html"><span class="doc">How to Find Data Source ID</span></a> for details.</p></li>
</ol>
</section>
<section id="step-1-enable-authservice">
<h2>STEP 1: Enable AuthService<a class="headerlink" href="#step-1-enable-authservice" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Enabling of AuthService requires a redeployment of <strong>alation_conf</strong> and a restart of the Alation server. Alation recommends to schedule this configuration at a time when users are the least active in the Catalog. A redeployment of <strong>alation_conf</strong> and a restart will cause the Alation user interface to reload and users may lose their unsaved work.</p>
</div>
<p>From version 2022.2, AuthService is enabled by default. In versions before 2022.2, perform the following configuration on the Alation server to enable AuthService:</p>
<ol class="arabic">
<li><p>Use SSH to connect to your Alation host.</p></li>
<li><p>Enter the Alation shell.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/etc/init.d/alation<span class="w"> </span>shell
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Check if the AuthService is enabled on your instance by checking the current value of the <strong>alation_conf</strong> parameter <code class="docutils literal notranslate"><span class="pre">alation.authentication.service.enabled</span></code>.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_conf<span class="w"> </span>alation.authentication.service.enabled
</pre></div>
</div>
<p>If the current value is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the AuthService is already enabled. If it’s <code class="docutils literal notranslate"><span class="pre">False</span></code>, then change the value to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div></blockquote>
</li>
<li><p>Set the value to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_conf<span class="w"> </span>alation.authentication.service.enabled<span class="w"> </span>-s<span class="w"> </span>True
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Deploy the configuration.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_action<span class="w"> </span>deploy_conf_all
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Restart Alation.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_action<span class="w"> </span>restart_alation
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>Stay in the Alation shell.</p>
</section>
<section id="step-2-configure-the-authservice-oauth-plug-in">
<h2>STEP 2: Configure the AuthService OAuth Plug-in<a class="headerlink" href="#step-2-configure-the-authservice-oauth-plug-in" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>From the Alation shell, enter the Django shell:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_django_shell
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>From the Django shell, initiate the OAuth plug-in configuration script by using the following commands:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>from<span class="w"> </span>rosemeta.one_off_scripts.configure_oauth<span class="w"> </span>import<span class="w"> </span>config_oauth_in_alation_shell

config_oauth_in_alation_shell<span class="o">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>This script will guide you through the configuration of every OAuth plug-in parameter. You will need to enter the information you collected from Azure AD. Refer to the table <a class="reference internal" href="#oauth-configuration-properties">OAuth Configuration Properties</a> below for descriptions of the properties that are configured with this script.</p>
<p>To apply a <em>default</em> value and move to the next prompt, press Enter.</p>
<p>Note that some prompts offer <em>sample</em> values. Sample values are examples of what a value should look like, but they cannot be applied as they are not equal to the default values. Provide your own values in place of sample values.</p>
<blockquote>
<div><div class="admonition important">
<p class="admonition-title">Important</p>
<p>During configuration, you will be required to specify a name for the OAuth configuration object (or use the default value of <code class="docutils literal notranslate"><span class="pre">azure_conf</span></code>). Save the name you use. It will be required if you need to perform any of the supported CRUD operations on this configuration object later.</p>
</div>
</div></blockquote>
<p>See an example of script usage below. After you move through all the steps in the configuration script, the SSO configuration is complete and you can test it in Alation.</p>
<blockquote>
<div><img alt="../../_images/AzureAD_ComposeSSO_10.png" src="../../_images/AzureAD_ComposeSSO_10.png" />
</div></blockquote>
</section>
<section id="oauth-configuration-properties">
<h2>OAuth Configuration Properties<a class="headerlink" href="#oauth-configuration-properties" title="Permalink to this headline">¶</a></h2>
<table class="longtable colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Prompt</p></th>
<th class="head"><p>Corresponding
property
in <em>AuthService</em></p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Please provide
a name for
this configuration
set</p></td>
<td><p>config_name</p></td>
<td><p>Name (string) representing this OAuth configuration.
The name can be any string; however, it cannot be an
existing name that was already used for another Auth Server
plugin.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">azure_conf</span></code></p>
</td>
</tr>
<tr class="row-odd"><td><p>OAuth token
endpoint URL</p></td>
<td><p>token_endpoint</p></td>
<td><p>The token endpoint URL in the standard OAuth flow. The auth
code received from the authorize_endpoint is passed to the
<code class="docutils literal notranslate"><span class="pre">token_endpoint</span></code> to retrieve access and refresh tokens.</p>
<p>Example:
<code class="docutils literal notranslate"><span class="pre">https://login.microsoftonline.com/common/oauth2/v2.0/token</span></code></p>
</td>
</tr>
<tr class="row-even"><td><p>OAuth authorize
endpoint URL</p></td>
<td><p>authorize_endpoint</p></td>
<td><p>The authorization endpoint URL in the standard OAuth flow
used to authorize a user principal. In Azure AD, if the app
is registered as multi-tenant, <code class="docutils literal notranslate"><span class="pre">/common/</span></code> is used in the
URL. If the app is registered as single-tenant, the tenant
ID is used in place of <code class="docutils literal notranslate"><span class="pre">/common/</span></code>.</p>
<p>Example:
<code class="docutils literal notranslate"><span class="pre">https://login.microsoftonline.com/common/oauth2/v2.0/authorize</span></code></p>
</td>
</tr>
<tr class="row-odd"><td><p>OAuth user info
endpoint URL</p></td>
<td><p>user_info_endpoint</p></td>
<td><p>The user info endpoint in the standard OAuth flow. For Azure
cloud, it is the following value:
<code class="docutils literal notranslate"><span class="pre">https://graph.microsoft.com/oidc/userinfo</span></code></p></td>
</tr>
<tr class="row-even"><td><p>OAuth redirect
URL for
receiving auth
code</p></td>
<td><p>redirect_url</p></td>
<td><p>The URL within Alation to accept the auth code from the OAuth
provider (in this case Azure).</p>
<p>Example:
<code class="docutils literal notranslate"><span class="pre">https://myalation.com/auth/callback/?method=oauth&amp;config_name=azure_conf</span></code></p>
</td>
</tr>
<tr class="row-odd"><td><p>Application Client
ID</p></td>
<td><p>client_id</p></td>
<td><p>Client ID of the application registered in Azure AD to represent
Alation.</p></td>
</tr>
<tr class="row-even"><td><p>Access Scope</p></td>
<td><p>scope</p></td>
<td><p>The access scopes associated with the tokens. These scopes will
be presented to the user for approval when redirected to the OAuth
provider. The following scopes are the minimum required
for Compose, representing user-impersonation and access to a
refresh token:
<code class="docutils literal notranslate"><span class="pre">https://database.windows.net/.default,offline_access</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>(Optional) Names
to use for
the authenticated
user</p></td>
<td><p>subject</p></td>
<td><p>JWT token field that identifies the user principal authenticated.
This field value is used to display the user session in Compose.
This is an optional field that is not required to be provided when
creating the configuration. Only use this configuration if the
user info that is identified in the JWT token uses any other key.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">ComposeAzureUser</span></code></p>
</td>
</tr>
<tr class="row-even"><td><p>(Optional) Access
Token lifespan
(in minutes)
before refetching
with Refresh Token</p></td>
<td><p>token_buffer_time</p></td>
<td><p>Buffer time to calculate if a new access token needs to
be generated or not.</p>
<p>Default: 10 (min)</p>
<p>Example:
If lifetime of a token is 60 min and Alation acquired the token
at 1:00 PM (UTC), Alation will reuse the same token till 1:50 PM
(UTC) even though the token is valid for 60 min. Then,
a new token will be generated if request comes at 1:51 PM (UTC).</p>
</td>
</tr>
<tr class="row-odd"><td><p>Now please provide
the Application
Client Secret
for encryption</p></td>
<td><p>n/a</p></td>
<td><p>The client secret for the Azure app representing Compose.
Alation will store the client secret in the encrypted format.</p></td>
</tr>
<tr class="row-even"><td><p>Please provide a
comma separated
list of data
source IDs in
Alation with
which to use
OAuth SSO.</p></td>
<td><p>n/a</p></td>
<td><p>Alation IDs of the data sources which are going
to use OAuth with Azure AD in Compose and for Dynamic Profiling.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="test-the-configuration">
<h2>Test the Configuration<a class="headerlink" href="#test-the-configuration" title="Permalink to this headline">¶</a></h2>
<p>To test your SSO setup:</p>
<ol class="arabic">
<li><p>Log in to Alation as a user who should be able to query an Azure data source from Compose.</p></li>
<li><p>From your Azure data source, go to Compose and establish a new connection. Instead of the Username and Password fields, the Data Source Authorization dialog should display the link <strong>Click here to authorize access before connecting…</strong></p>
<blockquote>
<div><img alt="../../_images/AzureAD_ComposeSSO_11.png" src="../../_images/AzureAD_ComposeSSO_11.png" />
</div></blockquote>
</li>
<li><p>Click the authorization link. The Azure AD login screen should open in a new browser tab.</p></li>
<li><p>Log in with your Azure AD credentials. After a successful login, the connection should be successfully established and you should be able to run queries in Compose.</p></li>
</ol>
<p>Note that with Compose SSO set up for your Azure data source, Dynamic Profiling will also require that users log in with their Azure AD credentials. When running a column profile, in the <strong>Connect to Data Source</strong> dialog, choose your SSO account and click <strong>Test Authorization</strong>:</p>
<blockquote>
<div><img alt="../../_images/AzureAD_ComposeSSO_12.png" src="../../_images/AzureAD_ComposeSSO_12.png" />
</div></blockquote>
<p>After authenticating with Azure AD, you will be able to submit your query by clicking <strong>Submit</strong>:</p>
<blockquote>
<div><img alt="../../_images/AzureAD_ComposeSSO_13.png" src="../../_images/AzureAD_ComposeSSO_13.png" />
</div></blockquote>
</section>
<section id="compose-sso-and-scheduled-queries">
<h2>Compose SSO and Scheduled Queries<a class="headerlink" href="#compose-sso-and-scheduled-queries" title="Permalink to this headline">¶</a></h2>
<p>With Compose SSO set up for an Azure data source, users are able to schedule published queries in Compose. Scheduled queries use the same OAuth flow as unscheduled Compose queries where Alation uses an existing access token to authorize Compose to use the data source. When it expires, Alation automatically requests a new access token using the previously acquired refresh token if the same session is maintained.</p>
<p>If users notice that their scheduled query failed, this may mean that the refresh token has expired. They need to go to Compose and re-authenticate with their Azure AD credentials in order to renew OAuth tokens.</p>
</section>
<section id="troubleshooting-compose-sso-with-azure-ad">
<h2>Troubleshooting Compose SSO with Azure AD<a class="headerlink" href="#troubleshooting-compose-sso-with-azure-ad" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 30%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Error</p></th>
<th class="head"><p>Use Case</p></th>
<th class="head"><p>Solutions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>{“message”: “failed to connect to
all addresses: &lt;…&gt;}</p></td>
<td><p><em>AuthServer</em> is not running so
GRPC calls fail</p></td>
<td><p>Restart the web services or restart the
Alation server.</p>
<p>To restart the web services:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_supervisor<span class="w"> </span>start<span class="w"> </span>java:authserver

alation_supervisor<span class="w"> </span>restart<span class="w"> </span>web:*
</pre></div>
</div>
<p>Or to restart Alation:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>alation_action<span class="w"> </span>restart_alation
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>Login failed for user
‘&lt;token-identified principal&gt;’</p></td>
<td><p>Azure AD authentication is
successful, but authorization for
the subject (user) failed because
the user does not have access
to the data source.</p></td>
<td><p>In Azure Portal, verify that the user can access
the resource with correct permissions.</p></td>
</tr>
<tr class="row-even"><td><p>Authorization terminated
unexpectedly.</p></td>
<td><p>The user did not go through
the Azure redirect. This may happen
if the browser tab was closed
before before Alation cloud receive
a response from Azure AD.</p></td>
<td><p>Try again by clicking
<strong>Click here to authorize access</strong>
<strong>before connecting…</strong></p></td>
</tr>
<tr class="row-odd"><td><p>Test Result: Error verifying
credentials. Please check your
username and password.</p></td>
<td><p>Azure AD authentication is
successful, but authorization
for the subject (user) failed
because the user does not have
access to the data source.</p></td>
<td><p>In the Azure Portal, verify that the user can
access the resource with correct permissions.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer>

  
<div class="navigation-bar">

    <div class="navigation navigation--prev">
        
        <a class="navigation__link" href="RegisterAADappForComposeSSO.html">
            <button class="navigation__button">
                <i class="icon icon-left"></i>
            </button>
            <div class="navigation__title">
                <span class="heading">Previous</span> <br />Compose SSO for Azure Data Sources: Register an Application in Azure AD
            </div>
        </a>
        
    </div>

    <div class="navigation navigation--next">
        
        <a class="navigation__link" title="Accesskey Alt(+Shift)+p" accesskey="p" href="OAuthPluginCRUDOperations.html">
            <div class="navigation__title">
                <span class="heading">Next</span> <br />OAuth Plugin CRUD Operations
            </div>
            <button class="navigation__button" title="Accesskey Alt(+Shift)+n" accesskey="n">
                <i class="icon icon-right"></i>
            </button>
        </a>
        
    </div>

</div>


</footer>

        </div>
      </div>

    </section>

    <div class="wy-nav-side wy-nav-secondary">
      <div class="wy-side-scroll">
        <div class="wy-side-scroll__content">
          <div class="wy-menu-secondary">
              <div class="comments">
    <a href="mailto:no-reply-docs-feedback@alation.com?subject=Documentation Feedback on datasources/ComposeSSOAzureDataSources/ConfigureComposeSSOwithAAD&body=Alation%20welcomes%20your%20comments%20on%20typos,%20content%20accuracy%20and%20completeness,%20and%20whether%20you%20found%20this%20page%20helpful.%20You%20will%20not%20receive%20a%20reply%20to%20this%20email.">
        <i class="icon icon-envelope" aria-hidden="true"></i>Request docs changes
    </a>
    <a href="#open-modal-pdf">
        <i class="icon icon-pdf" aria-hidden="true"></i>Download PDF
    </a>
</div>
              
                <p class="wy-menu-secondary-header">On this page</p>
                <ul>
<li><a class="reference internal" href="#">Compose SSO for Azure Data Sources: Configure Compose SSO in Alation</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#step-1-enable-authservice">STEP 1: Enable AuthService</a></li>
<li><a class="reference internal" href="#step-2-configure-the-authservice-oauth-plug-in">STEP 2: Configure the AuthService OAuth Plug-in</a></li>
<li><a class="reference internal" href="#oauth-configuration-properties">OAuth Configuration Properties</a></li>
<li><a class="reference internal" href="#test-the-configuration">Test the Configuration</a></li>
<li><a class="reference internal" href="#compose-sso-and-scheduled-queries">Compose SSO and Scheduled Queries</a></li>
<li><a class="reference internal" href="#troubleshooting-compose-sso-with-azure-ad">Troubleshooting Compose SSO with Azure AD</a></li>
</ul>
</li>
</ul>

              
            </div>
          </div>
      </div>
    </div>

  </div>

  
  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->

  
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../../_static/copybutton.js"></script>
      <script type="text/javascript" src="../../_static/js/rtd_sphinx_search.min.js"></script>
  
  <script type="text/javascript" src="../../_static/searchtools.js"></script> <script type="text/javascript" id="idPiwikScriptPlaceholder"></script><script type="text/javascript" src="../../_static/js/main.bundle.js"></script>
  <script type="text/javascript" src="../../_static/js/runtime.bundle.js"></script>

  
  

  
    <div id="open-modal-pdf" class="modal-window">
<div>
  <a href="#" title="Close" class="modal-close">Close</a>
  <h4>Alation Documentation PDF</h4>
  <p>This PDF contains all our documentation and is more than <b>120 MB</b> in size. We recommend using an ethernet or Wi-Fi connection for downloading.</p>
  <br>
  <div class="modal-buttons">
    <a href="https://pdf-docs.alation.com/AlationUserDocs.pdf" class="btn-cta btn-cta--primary" target="_blank">
      Download PDF
    </a>
    <a href="#" title="Close" class="btn-cta">Cancel</a>
  </div>
</div>
  

</body>
</html>
<!--3.6.17-->